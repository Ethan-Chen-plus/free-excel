## 2. 表格所见非所得

### 2.1 单元格数据类型

打开`数据格式demo`文件可以看到三种常见的数据类型，分别是数值、文本、日期，格式只是改变显示效果并不改变数据（表格所见非所得）。观察表格数据可以发现默认情况下，数值是右对齐的；文本是左对齐的；而日期是右对齐的。

#### 2.1.1 数值

数值是单元格最常见的数据之一，在单元格里面输入一位或多位数字回车就可以看到数值，12位数的时候会以科学计数法显示。下图展示的是真假数值列，真数值默认情况下是右对齐（方便观测数据位数），假数值是数值型文本属于文本，左上角会有个绿色三角错误检查。

![image-20210803181021382](images/image-20210803181021382.png)

![image-20210803181447823](images/image-20210803181447823.png)

#### 2.1.2 文本

常见的文本字符串，2.1.2的数值型文本也属于文本的数据。

![image-20210803181758928](images/image-20210803181758928.png)

#### 2.1.3 日期

日期由年月日组成的数据，例如`2021/1/1`，同时日期又是很特殊的数值，在Excel里面日期最早是1900年1月1日，对应的数值为1，通过两日期相减可以得到日期相差的天数。需要注意的是如果是`2021-01-01`的数据就要看是否实际数据为`'2021/1/1'`，否则为文本型日期，需要进行转换才行。观察下图真假日期，可以发现真日期右对齐，假日期左对齐（内容跟显示的一致），真日期转格式可以看到单元格数据仍然是真日期格式（内容跟显示不一致）。

![image-20210803183521589](images/image-20210803183521589.png)

![image-20210803183217830](images/image-20210803183217830.png)


### 2.2 单元格格式

#### 2.2.1 设置单元格格式

设置单元格格式可以点击单元格后，**右键-设置单元格格式**选项，或者按快捷键**ctrl+1**，或者通过工具栏：**开始-数字**去快速做更改。单元格可以设置的格式类型包括：

* 数字：调整数值格式或者日期格式。
* 对齐：调整对齐方式。
* 字体：更改字体、字型、字号等。
* 边框：单元格边框设置。
* 填充：填充单元格背景颜色，标注数据经常使用。
* 保护：锁定单元格或者隐藏公式。



![image-20210803184545892](images/image-20210803184545892.png)

#### 2.2.2 数值格式

设置单元格格式分类选择数值，对数值设置小数点一般保留两位，同时能让数值对齐，使用千分位分隔符能更容易观察数值大小。

![image-20210909174646086](images/image-20210909174646086.png)

#### 2.2.3 文本格式

文本常见的设置格式用于对文本进行加单引号、双引号或者逗号的情况。以`user_orders.xlsx`文件为例，对`email`列进行添加单引号的操作。

首先选择`email`列，调出设置单元格格式，分类选择``自定义``，找到`@`后在外面加上单引号。

![image-20210804153109267](images/image-20210804153109267.png)

![image-20210804164256935](images/image-20210804164256935.png)

#### 2.2.4 日期格式

通过日期分类调整日期格式为年-月-日，需要注意的是文本型的日期格式无法调整，而数值是可以调整为日期。

![image-20210909174711729](images/image-20210909174711729.png)

### 2.3 转换单元格数据

通过数据工具的`分列`功能能够巧妙的将数据进行转换，以下将使用`user_orders`表为例进行操作。

#### 2.3.1 数值和文本相互转换

将`数值型文本`转为`数值`，选择`order_id`列并使选择分列功能，默认下一步直至完成。

![image-20210804170035414](images/image-20210804170035414.png)

![image-20210804170119449](images/image-20210804170119449.png)

![image-20210804170142247](images/image-20210804170142247.png)

#### 2.3.2 日期和文本相互转换

将`文本日期`转换为`日期`，选择`update_date`列并选择`分列`功能，到第三步的时候选择`日期`点击完成。

![image-20210804165530941](images/image-20210804165530941.png)

![image-20210804165604695](images/image-20210804165604695.png)

![image-20210804165624802](images/image-20210804165624802.png)



### 任务

1. 将`Titanic_train`工作簿中的`Pclass`列的数值转文本
2. 将`user_orders`工作簿的`isbn`列的文本型数值转数值
